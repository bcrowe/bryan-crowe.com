<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>CakePHP 3.0 Models</title>
        <meta name="viewport" content="width=device-width">
        <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/css/font-awesome.min.css">
        <link rel="stylesheet" href="/css/syntax.css">
        <link rel="stylesheet" href="/css/style.css">
    </head>
    <body>
      
        <video id="bkg-video" class="blur" preload="auto" autoplay="true" loop="loop" muted="muted" volume="0">
          <source src="/videos/drink-bw.mp4">
          <source src="/videos/drink-bw.webm">
        </video>
      
      <div class="container">
        <div class="row">
          <div id="sidebar" class="col-md-3">
            <div class="affix">
              <h1 id="my-name"><a href="/">BRYAN<span class="last-name">CROWE</span></a></h1>
              <div id="external-links">
                <a href="//github.com/bcrowe" target="_blank">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-github fa-stack-2x"></i>
                  </span>
                </a>
                <a href="//twitter.com/_beakman" target="_blank">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
                <a href="mailto:bryan@bryan-crowe.com">
                  <span class="fa-stack fa-lg">
                    <i class="fa fa-circle fa-stack-2x"></i>
                    <i class="fa fa-pencil fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </div>
              <p>
                Bryan Crowe is a beer-drinking open source developer living in Pittsburgh, PA. He is involved in the <a class="text-link" href="http://www.cakephp.org" target="_blank">CakePHP</a> framework.
              </p>
            </div>
          </div>
          <div class="col-md-9">
            <article class="post">
<h2 class="post-title">CakePHP 3.0 Models</h2>
<time class="post-time">Mar 29, 2014</p>

<p>Models in CakePHP 3.0 have been split into two seperate ideas: Tables and Entities. A Table represents a table in your database which is reminiscent of the all-encapsulating Model classes in previous versions of CakePHP. Table classes reside within &quot;App/Model/Table&quot; and have took on a plural form: <code>class ArticlesTable extends Table</code> and <code>ArticlesTable.php</code>. Entities on the other hand, represent an individual row within a database table. Entities reside within &quot;App/Model/Entity&quot; and are in singular form: <code>class Article extends Entity</code> and <code>ArticleEntity.php</code>. This introduces a seperation of concerns.</p>

<p>For example, in CakePHP 2.x you could aquaint a &quot;virtual field&quot; that concatenates two fields together using the &quot;$virtualFields&quot; property within a Model:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="nv">$virtualFields</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;full_name&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;CONCAT(User.first_name, &quot; &quot;, User.last_name)&#39;</span>
<span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

<p>But, to aquaint a &quot;virtual field&quot; in CakePHP 3.0, you would define an accessor method within your Entity such as:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">getFullName</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_properties</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]</span> <span class="o">.</span> <span class="s1">&#39;  &#39;</span> <span class="o">.</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_properties</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">];</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

<p>This makes <code>$user-&gt;full_name</code> an accessible property of your result set. Note that the property name is the lowercased and underscored version of the accessor&#39;s name.</p>

<p>On the other hand, addresssing associations between Models in CakePHP 2.x you would set the <code>$hasMany</code> property something similiar to:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="nv">$hasMany</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;User&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

<p>But, definfing associations between Models in CakePHP 3.0 is done through Table&#39;s initialize method:</p>

<div class="highlight"><pre><code class="php"><span class="cp">&lt;?php</span>
<span class="k">public</span> <span class="k">function</span> <span class="nf">initialize</span><span class="p">(</span><span class="k">array</span> <span class="nv">$config</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">belongsTo</span><span class="p">(</span><span class="s1">&#39;Users&#39;</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>

</article>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'bryancrowe'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

          </div>
        </div>
      </div>
      <script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
      <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
      <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-46695861-1', 'bryan-crowe.com');
        ga('send', 'pageview');

      </script>
    </body>
</html>
